<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">    
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.5.3/jspdf.debug.js" integrity="sha384-NaWTHo/8YCBYJ59830LTz/P4aQZK1sS0SneOgAvhsIl3zBu8r9RevNg5lHCHAuQ/" crossorigin="anonymous"></script>
    
    <script src="js/pdf.js"></script>
    <script src="js/dyr.js"></script>
    <script src="js/colour.js"></script>
    <title>AlleDyr</title>
</head>
<body>
    <!-- NAVBAR -->
    <nav class="navbar navbar-expand-sm bg-dark navbar-dark">
        <div class="container-fluid">
          <a class="navbar-brand" href="minedyr.html">DYREBASEN</a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#collapsibleNavbar">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse justify-content-end" id="collapsibleNavbar">
            <ul class="navbar-nav">
              <li class="nav-item">
                <a class="nav-link" href="regdyr.html">Registrer ny kanin</a>
              </li>
              <li class="nav-item">
                <a class="nav-link active" href="minedyr.html">Mine kaniner</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#">Til salgs</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#">Min bruker</a>
              </li>
            </ul>
          </div>
        </div>
      </nav>
    
    <!-- Edit Modal -->
    <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="container-fluid">
                        <form>
                            <div class="row">
                                <div class="col">
                                    <label for="inpRegNr" class="form-label">Reg.nr:</label><br>
                                    <input id="inpRegNr" type="number" class="form-control" /><br>
                                </div>
                                <div class="col">
                                    <label for="inpVø" class="form-label">V.Ø:</label>
                                    <input id="inpVø" type="text" class="form-control" /><br>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col">
    
                                    <label for="inpFdato" class="form-label">Fødselsdato:</label>
                                    <input id="inpFdato" type="date"  class="form-control"/><br>
                            
                                </div>
                                <div class="col">
    
                                    <label for="inpKullNr" class="form-label">Kullnummer</label>
                                    <input id="inpKullNr" type="number" class="form-control" /><br>
                            
                                </div>
                            </div>
                            <div class="row">
                                <div class="col">
                                                                
                                    <label for="dropKjønn" class="form-label">Kjønn:</label>
                                    <select id="dropKjønn">
                                        <option value="Male">Male</option>
                                        <option value="Female">Female</option>
                                    </select>
                                    <br>

                                </div>
                                <div class="col">
    
                                    <label for="inpInnavlsgrad" class="form-label">Innavlsgrad:</label>
                                    <input id="inpInnavlsgrad" type="number" class="form-control" /><br>
                            
                                </div>
                            </div>
                            <div class="row">
                                <div class="col">
    
                                    <label for="inpPoeng" class="form-label">Poeng:</label>
                                    <input id="inpPoeng" type="number" max="100" class="form-control" /><br>
                            
                                </div>
                                <div class="col">
    
                                    <label for="inpFarge" class="form-label">Farge:</label>
                                    <input class="form-control" list="fargeValg" id="inpFarge" placeholder="Skriv inn en farge...">
                                    <datalist id="fargeValg">
                                    </datalist>
                                    <br>
                            
                                </div>
                           </div>
                            <div class="row">
                                <div class="col">
    
                                    <label for="inpFar" class="form-label">Far:</label>
                                    <input class="form-control" list="valgFar" id="inpFar" placeholder="finn foreldre (regnr)...">
                                    <datalist id="valgFar">
                                    </datalist>
                                    <br>
                            
                                </div>
                                <div class="col">
    
                                    <label for="inpMor" class="form-label">Mor:</label>
                                    <input class="form-control" list="valgMor" id="inpMor" placeholder="finn foreldre (regnr)...">
                                    <datalist id="valgMor">
                                    </datalist>
                                    <br>
                            
                                </div>
                           </div>
                            <div class="row">
                                    <label for="inpBilde" class="form-label">Last opp bilde:</label>
                                    <input class="form-control" type="file" id="inpBilde"><br>
                           </div>
                        </form>
                    </div>
                </div>
                <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" id="btnEditAnimal" class="btn btn-primary" data-bs-dismiss="modal">Save changes</button>
                </div>
            </div>
        </div>
    </div>    
    <!----------- HTML-elements -------------->

    <h1 style="margin-left: 10px;">MINE DYR</h1>

    <div id="container"></div>

    
    <!------------- JavaScript --------------->
    <script>
        
        let container = document.getElementById('container');
        let btnEditAnimal = document.getElementById('btnEditAnimal');
        let testBilde = document.getElementById('testBilde'); 
        let activeID = null;
        listAnimals(); 
        let originalInputValues = {};
        async function loadHTMLElements(selectedID) {
            

            let clickedAnimal = "";
            clickedAnimal = await getSingleAnimal(selectedID)
            
            inpRegNr.value = clickedAnimal.regnr;
            inpVø.value = clickedAnimal.vø;
            inpFdato.value = clickedAnimal.fdato;
            inpKullNr.value = clickedAnimal.kullnr;
            dropKjønn.value = clickedAnimal.kjønn;
            inpInnavlsgrad.value = clickedAnimal.innavlsgrad;
            inpPoeng.value = clickedAnimal.poeng;
            inpFarge.value = clickedAnimal.farge;
            inpFar.value = clickedAnimal.far;
            inpMor.value = clickedAnimal.mor;
            //inpBilde.value = clickedAnimal.bilde;

            originalInputValues = {
                regnr: inpRegNr.value,
                vø: inpVø.value,
                fdato: inpFdato.value,
                kullnr: inpKullNr.value,
                kjønn: dropKjønn.value,
                innavlsgrad: inpInnavlsgrad.value,
                poeng: inpPoeng.value,
                farge: inpFarge.value,
                far: inpFar.value,
                mor: inpMor.value,
                bilde: inpBilde.value
            }
            activeID = selectedID;
            //console.log(originalInputValues);
        }
        function filterUpdata(params) {
            let updata = {
                did: activeID,
                regnr: inpRegNr.value,
                vø: inpVø.value,
                fdato: inpFdato.value,
                kullnr: inpKullNr.value,
                kjønn: dropKjønn.value,
                innavlsgrad: inpInnavlsgrad.value,
                poeng: inpPoeng.value,
                farge: inpFarge.value,
                far: inpFar.value,
                mor: inpMor.value,
                bilde: bildeData
            }
            for (const key in updata) {
                if (updata[key] === originalInputValues[key] || key === "bilde") {
                    delete updata[key]
                }
            }
            return updata;
        }
        btnEditAnimal.addEventListener('click', async function (evt) {
            evt.preventDefault();
            let updata = filterUpdata();
            if (Object.keys(updata).length > 1) {
                await updateAnimal(updata);
            }else{
                throw "nothing changed"
            }
            
            
        })

    </script>

    <!---------------- CSS ------------------->
    <style>    
    
    button {
        border-radius: 5px;
    }
    
    
    button:hover {
        cursor: pointer;
    }

    body {
        background-color: rgb(248, 208, 159);
    }

    .item1 {grid-area: img;
            width: 125px;
            border-radius: 100px;
            align-self: center;
            justify-self: center;}
    .item2 {grid-area: did;
            align-self: center;
            justify-self: center;}
    .item3 {grid-area: regNr;}
    .item4 {grid-area: vø;}
    .item5 {grid-area: fDato;}
    .item6 {grid-area: kullNr;}
    .item7 {grid-area: kjønn;}
    .item8 {grid-area: innavlsgrad;}
    .item9 {grid-area: poeng;}
    .item10 {grid-area: farge;}
    .item11 {grid-area: far;}
    .item12 {grid-area: mor;}
    .slett {grid-area: slett;
            margin: 2px;}
    .rediger {grid-area: rediger;
            margin: 2px;}
    .genstam {grid-area: genstam;
            height: 35px;
            margin-top: 10px;
            margin-right: 5px;}
        

    .mineDyr {
        display: grid;
        grid-template-columns: 200px 200px 200px 35px;
        grid-template-rows: 35px 35px 35px 35px 35px 35px;
        grid-template-areas: 
            "img regNr innavlsgrad slett"
            "img vø poeng rediger"
            "img fDato farge farge"
            "img kullNr far far"
            "img kjønn mor mor"
            "did genstam genstam genstam";
        border: 1px solid black;
        cursor: pointer;
        margin: 10px;
        background-color: bisque;

        max-width: 644px;
    }

    /* .mineDyr>img {
        grid-area: img;
        width: 100px;
    }

    .mineDyr>h2 {
        grid-area: did;
    }

    .mineDyr>p:nth-child(3) {
        grid-area: regNr;
    }

    .mineDyr>p:nth-child(4) {
        grid-area: vø;
    }

    .mineDyr>p:nth-child(5) {
        grid-area: fDato;
    }

    .mineDyr>p:nth-child(6) {
        grid-area: kullNr;
    }

    .mineDyr>p:nth-child(7) {
        grid-area: kjønn;
    }

    .mineDyr>p:nth-child(8) {
        grid-area: innavlsgrad;
    }

    .mineDyr>p:nth-child(9) {
        grid-area: poeng;
    }

    .mineDyr>p:nth-child(10) {
        grid-area: farge;
    }

    .mineDyr>p:nth-child(11) {
        grid-area: far;
    }

    .mineDyr>p:nth-child(12) {
        grid-area: mor;
    } */
    




    </style>

    <script src="js/popper.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/form.js"></script> <!-- Håndterer alt av forms-->
</body>

</html>
